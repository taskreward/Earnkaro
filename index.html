<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Casino Dashboard</title>
  <!-- CSS styles (omitted here for brevity but should include all from previous setup) -->
</head>
<body>
  <!-- Login Page -->
  <div id="loginPage" class="login-container">
    <!-- login form with inputs and login button -->
  </div>

  <!-- Dashboard -->
  <div id="dashboardPage" class="dashboard hidden">
    <header>
      <!-- Avatar Upload -->
      <!-- User Info and Withdraw Button -->
    </header>

    <!-- KPI Bar -->
    <!-- Tabs for Daily Tasks -->
    <!-- Live Feed -->
    <ul class="task-list" id="task-list"></ul>
  </div>

  <script>
    // Login Function
    function loginUser() {
      const name = loginUsername.value.trim();
      const email = loginEmail.value.trim();
      const pass = loginPassword.value.trim();
      if (!name || !email || !pass) return alert("Fill all fields");
      const user = { name, email, id: Date.now(), vip: 0, avatar: '' };
      const data = { user, balance: 0, tasksDone: 0, weeklyWin: 0, claimed: {}, processing: {} };
      localStorage.setItem('casinoUser', JSON.stringify(data));
      showDashboard();
    }

    // Show Dashboard
    function showDashboard() {
      const s = JSON.parse(localStorage.getItem('casinoUser'));
      if (!s) return;
      loginPage.classList.add('hidden');
      dashboardPage.classList.remove('hidden');
      displayUsername.textContent = s.user.name;
      displayMeta.textContent = `ID: ${s.user.id} | ${s.user.email} | VIP${s.user.vip}`;
      if (s.user.avatar) userAvatar.src = s.user.avatar;
      updateKPI();
      renderTasks('daily');
    }

    // Update KPI
    function updateKPI() {
      const s = JSON.parse(localStorage.getItem('casinoUser'));
      balanceDisplay.textContent = `â‚¹${s.balance}`;
      kpiTasks.textContent = s.tasksDone;
      kpiWeekly.textContent = `â‚¹${s.weeklyWin}`;
    }

    // Avatar Upload
    function uploadAvatar(e) {
      const reader = new FileReader();
      reader.onload = () => {
        const s = JSON.parse(localStorage.getItem('casinoUser'));
        s.user.avatar = reader.result;
        localStorage.setItem('casinoUser', JSON.stringify(s));
        userAvatar.src = reader.result;
      };
      reader.readAsDataURL(e.target.files[0]);
    }

    // Render Tasks
    function renderTasks(tab) {
      const saved = JSON.parse(localStorage.getItem('casinoUser'));
      const list = document.getElementById('task-list');
      list.innerHTML = '';
      const tasks = Array.from({length: 6}, (_, i) => ({
        title: `ðŸŽ² Task ${i+1}`,
        meta: `Earn â‚¹${12+i*2}`,
        reward: 12+i*2,
        key: `daily_task_${i}`
      }));

      tasks.forEach(t => {
        const li = document.createElement('li');
        li.className = 'task-card';
        const last = saved.claimed[t.key] || 0;
        const pending = saved.processing[t.key] || 0;
        const now = Date.now();

        let btnText = 'Claim';
        let disabled = false;

        if (pending && now - pending < 3 * 60 * 1000) {
          btnText = 'Processing...';
          disabled = true;
        } else if (pending && now - pending >= 3 * 60 * 1000) {
          saved.balance += t.reward;
          saved.tasksDone++;
          saved.weeklyWin += t.reward;
          saved.claimed[t.key] = now;
          delete saved.processing[t.key];
          localStorage.setItem('casinoUser', JSON.stringify(saved));
          updateKPI();
        } else if (now - last < 25 * 3600 * 1000) {
          btnText = 'Wait 25h';
          disabled = true;
        }

        li.innerHTML = `
          <div class="accent" style="background:gold"></div>
          <div class="task-info">
            <div class="task-title">${t.title}</div>
            <div class="task-meta">${t.meta}</div>
          </div>
          <button class="btn-claim" ${disabled ? 'disabled' : ''}>${btnText}</button>
        `;

        const btn = li.querySelector('button');
        btn.onclick = () => {
          if (btnText !== 'Claim') return;
          saved.processing[t.key] = Date.now();
          localStorage.setItem('casinoUser', JSON.stringify(saved));
          window.open("https://example.com", "_blank");
          renderTasks(tab);
        };

        list.appendChild(li);
      });
    }

    // Auto Load Dashboard
    window.onload = showDashboard;
  </script>
</body>
</html>
